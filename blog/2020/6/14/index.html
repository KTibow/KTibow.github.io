<!DOCTYPE html>
<html lang="en-US">

<head>
    <script async src="/common.js"></script>
    <title>6/14/2020 Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        body {
            background: lavender;
        }
    </style>
</head>

<body>
    <!--    document.getElementById("telfield").addEventListener("keyup", function(event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        make()
      }
    });-->
    <h1>6/14/2020: Tag Manager</h1>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;I was going to write something about how to make a tag manager by your self, but my parents came in so I'm stopping.</p>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;Never mind, I'm back on. Basically, instead of Google Tag manager, you're going to use something called <span style="font-family: monospace; background-color: #EEE;">common.js</span> instead. You'll host it on your own server,
        instead of Google's servers (but if you really want to they have storage APIs for that...)</p>
    <p>&nbsp;&nbsp;&nbsp;&nbsp;Anyway, here's the maker:</p>
    <script>
        function safetext(str) {
            return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
        }

        function handleText() {
            console.log("Handling display");
            var gacheck = document.getElementById("gacheck").checked;
            var commonjsfill = "";
            if (gacheck) {
                document.getElementById("srcga").style.display = "block";
                document.getElementById("selfgalab").style.display = "block";
                document.getElementById("ganumlab").style.display = "block";
                var gaselect = document.getElementById("gachoose").value;
                var selfhost = document.getElementById("selfga").checked;
                if (gaselect == "analytics") {
                    commonjsfill += `(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','`;
                    if (!selfhost) {
                        commonjsfill += "https://www.google-analytics.com/analytics.js', 'ga');";
                    }
                    commonjsfill += "ga('create', 'UA-XXXXX-Y', 'auto');ga('send', 'pageview');";
                }
            } else {
                document.getElementById("srcga").style.display = "none";
                document.getElementById("selfgalab").style.display = "none";
                document.getElementById("ganumlab").style.display = "none";
            }
            document.getElementById("commonjscode").innerHTML = safetext(commonjsfill);
        }
    </script>
    <label>Include Google Analytics <input type="checkbox" id="gacheck" onclick="handleText()">
    </label>
    <br/>
    <label id="srcga">Google Analytics type <select id="gachoose" onchange="handleText()">
            <option value="analytics">analytics.js</option>
            <option value="ga">ga.js</option>
            <option value="gtag">gtag.js</option>
        </select>
    </label>
    <br/>
    <label id="ganumlab">Google Analytics number <input id="ganum" onchange="handleText()">
    </label>
    <br/>
    <label id="selfgalab">Self-hosted Google Analytics <input type="checkbox" id="selfga" onclick="handleText()">
    </label>
    <br/>
    <h2><u>Your</u> <span style="font-family: monospace; background-color: #EEE;">common.js</span></h2>
    <code style="font-family: monospace; background-color: #EEE;" id="commonjscode"></code>
    <p>Include it like this:</p>
    <code style="font-family: monospace; background-color: #EEE;">&lt;script defer src="/common.js"&gt;&lt;/script&gt;</code>

    <script>
        handleText();
    </script>
</body>

</html>
